
# BulTrans – Bulgarian Invoice Conversion System 🇧🇬

BulTrans is a FastAPI-based system that converts English PDF invoices into legally-compliant Bulgarian Word (.docx) format.

---

## ✅ Features

- Extracts customer name, VAT, company ID, address, city
- Automatically translates fields like name, city, and address into Bulgarian
- Detects total amount and VAT flexibly from different layouts
- Converts total amount into Bulgarian words (internal logic)
- Fetches currency exchange rate from BNB.bg based on invoice date, with fallback rates for common currencies
- Inserts all values into a pre-defined Word template
- Outputs a ready-to-sign Word invoice in Bulgarian format

---

## 📦 Installation

```bash
pip install -r requirements.txt
```

---

## 🚀 Running Locally

```bash
uvicorn main:app --reload
```

---

## 🧾 API Endpoints

### `POST /process-invoice/`

Upload an English PDF invoice and a Word template to generate a Bulgarian Word invoice.

**Form Fields:**
- `supplier_id` (int): Matches `SupplierCompanyID` in `suppliers.xlsx`
- `file` (PDF): The English invoice
- `template` (.docx): The Word template with `{{placeholders}}`

**Example:**
```bash
curl -X POST http://localhost:8000/process-invoice/ \
  -F "supplier_id=206232541" \
  -F "file=@Invoice.pdf" \
  -F "template=@templates/BulTrans_Template_Final.docx"
```

---

### `GET /download-invoice/{filename}`

Download the generated Word invoice using the file name provided in the response.

---

## 📁 File Structure

```
bultrans/
├── main.py                       # FastAPI app with endpoints
├── process.py                    # Main invoice processing logic
├── suppliers.xlsx                # Supplier data (IBAN, VAT, contact)
├── requirements.txt              # Python dependencies
├── templates/
│   └── BulTrans_Template_Final.docx  # Word template with placeholders
└── README.md
```

---

## 💡 Notes

- If exchange rate is missing from BNB, fallback rates are used (USD, EUR, ILS, GBP).
- Default service description is "Услуга по договор" if not found in the invoice.
- All numeric values are formatted in Bulgarian text (e.g., 5640 → "Пет хиляди шестстотин и четиридесет лева").

---

Made with ❤️ in Bulgaria 🇧🇬
